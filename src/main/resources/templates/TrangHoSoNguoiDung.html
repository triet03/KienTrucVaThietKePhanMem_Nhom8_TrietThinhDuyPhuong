<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Giao Diện Sidebar</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      background-color: #f4f4f9;
    }
    header {
      background-color: #007bff;
      color: white;
      padding: 15px 20px;
      text-align: left;
      font-size: 18px;
      width: 100%;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 1000;
    }
    .home-button {
      background-color: #007bff;
      color: white;
      padding: 10px 20px;
      border: none;
      cursor: pointer;
      font-size: 18px;
      text-align: center;
      text-decoration: none;
      border-radius: 5px;
    }
    .sidebar {
      width: 250px;
      background-color: white;
      padding-top: 20px;
      color: #4e73df;
      height: 100vh;
      position: fixed;
      padding-left: 10px;
      box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
      top: 60px;
    }
    .sidebar a {
      color: #4e73df;
      padding: 10px;
      text-decoration: none;
      display: block;
      font-size: 16px;
      border-left: 5px solid transparent;
      position: relative;
    }
    .sidebar a:hover {
      background-color: #f1f1f1;
      border-left: 5px solid #007bff;
    }
    .sidebar .submenu a {
      font-size: 14px;
      padding-left: 30px;
    }
    .submenu { display: none; }
    .submenu.active { display: block; }
    .main-content {
      margin-left: 250px;
      padding: 30px 30px 60px 30px;
      flex-grow: 1;
      margin-top: 80px;
    }
    .profile-container {
      max-width: 700px;
      margin: 0 auto;
      background: #fff;
      padding: 32px 24px 24px 24px;
      border-radius: 14px;
      box-shadow: 0 8px 24px rgba(80,90,120,0.09);
    }
    .profile-title {
      color: #007bff;
      margin-bottom: 24px;
    }
    .info-row {
      display: flex;
      margin-bottom: 12px;
    }
    .info-label {
      width: 160px;
      color: #555;
      font-weight: bold;
    }
    .info-value { color: #222; }
    .no-info { color: #aaa; }
    .btn-edit {
      display: inline-block;
      padding: 8px 20px;
      border-radius: 8px;
      background: #007bff;
      color: #fff;
      text-decoration: none;
      margin-top: 18px;
      transition: background 0.18s;
    }
    .btn-edit:hover { background: #0056b3; }
  </style>
</head>
<body>

<!-- Header -->
<header style="
  display: flex;
  align-items: center;
  justify-content: space-between;
  background-color: #0080ff;
  color: white;
  padding: 7px 24px 7px 18px;  /* giảm padding */
  font-size: 17px;             /* giảm font */
  border-radius: 16px 16px 0 0;
  height: 48px;                 /* thu nhỏ chiều cao */
  box-sizing: border-box;
">
  <div style="font-weight: bold;">Trang Chủ</div>
  <div style="display: flex; align-items: center; gap: 16px;">
    <div style="font-weight: bold; white-space: nowrap;" th:text="${candidate.fullName}">Tên Ứng Viên</div>
    <button onclick="logout()" style="
      display: flex; align-items: center;
      background: #fff;
      color: #0080ff;
      font-weight: 600;
      border: none;
      border-radius: 25px;
      padding: 5px 15px;
      font-size: 15px;
      cursor: pointer;
      box-shadow: 0 1px 6px rgba(0,0,0,0.04);
      transition: background 0.13s;
      white-space: nowrap;
    ">
      <svg width="18" height="18" fill="currentColor" style="margin-right:5px;"><path d="M6 3a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1v5a1 1 0 1 1-2 0V4H8v14h6v-4a1 1 0 1 1 2 0v5a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V3Zm12.707 7.707a1 1 0 0 0-1.414-1.414l-3 3a1 1 0 0 0 0 1.414l3 3a1 1 0 1 0 1.414-1.414L17.414 13H12a1 1 0 1 0 0 2h5.414l-1.707 1.707Z"/></svg>
      Đăng xuất
    </button>
  </div>
</header>



<!-- Sidebar -->
<div class="sidebar">
  <a href="javascript:void(0);" onclick="toggleSubMenu('submenu1')">Quản lý tài khoản</a>
  <div id="submenu1" class="submenu">
    <a href="#">Tài khoản của bạn</a>
  </div>
  <a href="javascript:void(0);" onclick="toggleSubMenu('submenu2')">Quản lý hồ sơ</a>
  <div id="submenu2" class="submenu">
    <a th:href="@{'/candidates/hoso-cua-ban/' + ${candidate.canId}}">Hồ sơ của bạn</a>
    <a href="/hoso-candidate">Cập nhật thông tin</a>
  </div>
  <a href="javascript:void(0);" onclick="toggleSubMenu('submenu3')">Quản lý việc làm</a>
  <div id="submenu3" class="submenu">
    <a href="#">Việc làm đã ứng tuyển</a>
    <a href="#">Việc làm đã lưu</a>
    <a href="#">Việc làm chờ ứng tuyển</a>
    <a href="#">Thông báo việc làm</a>
    <a href="/Timkiemvieclam">Tìm kiếm việc làm</a>
  </div>
  <a href="javascript:void(0);" onclick="toggleSubMenu('submenu4')">Nhà tuyển dụng bạn quan tâm</a>
  <div id="submenu4" class="submenu">
    <a href="#">Nhà tuyển dụng xem hồ sơ bạn</a>
    <a href="#">Nhà tuyển dụng đang theo dõi</a>
  </div>
  <a href="javascript:void(0);" onclick="toggleSubMenu('submenu5')">Hỗ trợ và thông báo</a>
  <div id="submenu5" class="submenu">
    <a href="#">Việc làm 24h thông báo</a>
    <a href="#">Hướng dẫn sử dụng</a>
  </div>
</div>

<!-- Main Content (PROFILE) -->
<div class="main-content">
  <div class="profile-container">
    <h2 class="profile-title">Thông tin tài khoản ứng viên</h2>
    <div class="info-row">
      <div class="info-label">Họ tên:</div>
      <div class="info-value" th:text="${candidate.fullName}">Tên Ứng Viên</div>
    </div>
    <div class="info-row">
      <div class="info-label">Email:</div>
      <div class="info-value" th:text="${candidate.email}">email@example.com</div>
    </div>
    <div class="info-row">
      <div class="info-label">Ngày sinh:</div>
      <div class="info-value" th:if="${candidate.dob != null}" th:text="${#dates.format(candidate.dob, 'dd/MM/yyyy')}"></div>
      <div class="info-value no-info" th:if="${candidate.dob == null}">Chưa cập nhật</div>
    </div>
    <div class="info-row">
      <div class="info-label">Số điện thoại:</div>
      <div class="info-value" th:text="${candidate.phone != null ? candidate.phone : 'Chưa cập nhật'}"></div>
    </div>
    <div class="info-row">
      <div class="info-label">Địa chỉ:</div>
      <div class="info-value" th:if="${candidate.address != null}">
        <span th:text="${candidate.address.number}"></span>
        <span th:if="${candidate.address.number != null}">, </span>
        <span th:text="${candidate.address.street}"></span>
        <span th:if="${candidate.address.street != null}">, </span>
        <span th:text="${candidate.address.city}"></span>
        <span th:if="${candidate.address.city != null}">, </span>
        <span th:text="${candidate.address.zipcode}"></span>
      </div>
      <div class="info-value no-info" th:if="${candidate.address == null}">Chưa cập nhật</div>
    </div>
    <div class="info-row" th:if="${candidate.summary != null}">
      <div class="info-label">Giới thiệu:</div>
      <div class="info-value" th:text="${candidate.summary}"></div>
    </div>
    <a class="btn-edit" th:href="@{'/candidates/edit/' + ${candidate.canId}}">Chỉnh sửa</a>
    <button class="btn-edit" style="margin-left: 16px; background: #28a745" onclick="showChangePasswordForm()">Đổi mật khẩu</button>

    <!-- Modal đổi mật khẩu -->
    <div id="changePasswordModal" style="display: none; position: fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.25); z-index:2000;">
      <div style="background: #fff; max-width:400px; margin:120px auto; border-radius:10px; box-shadow:0 6px 24px rgba(0,0,0,0.13); padding:30px; position:relative;">
        <h3 style="margin-bottom:20px;">Đổi mật khẩu</h3>
        <form id="changePasswordForm" method="post" th:action="@{'/candidates/change-password/' + ${candidate.canId}}">
          <div style="margin-bottom:10px;">
            <label>Mật khẩu cũ:</label><br/>
            <input type="password" name="oldPassword" required style="width:100%;padding:7px;"/>
          </div>
          <div style="margin-bottom:10px;">
            <label>Mật khẩu mới:</label><br/>
            <input type="password" name="newPassword" required style="width:100%;padding:7px;"/>
          </div>
          <div style="margin-bottom:16px;">
            <label>Xác nhận mật khẩu mới:</label><br/>
            <input type="password" name="confirmPassword" required style="width:100%;padding:7px;"/>
          </div>
          <button type="submit" style="padding:8px 22px; background:#007bff; color:#fff; border:none; border-radius:7px; cursor:pointer;">Lưu mật khẩu</button>
          <button type="button" onclick="hideChangePasswordForm()" style="margin-left:16px; background:#ccc; color:#222; border:none; padding:8px 14px; border-radius:7px; cursor:pointer;">Hủy</button>
        </form>
      </div>
    </div>

    <div id="msg-box">
      <div th:if="${errorMessage}" style="color: red; margin-bottom:12px;" th:text="${errorMessage}"></div>
      <div th:if="${successMessage}" style="color: green; margin-bottom:12px;" th:text="${successMessage}" id="successMsg"></div>
    </div>

  </div>
</div>

<script>
  function toggleSubMenu(submenuId) {
    const submenu = document.getElementById(submenuId);
    submenu.classList.toggle('active');
  }
  function goHome() {
    window.location.href = "/home";
  }
  function showChangePasswordForm() {
    document.getElementById("changePasswordModal").style.display = "block";
  }
  function hideChangePasswordForm() {
    document.getElementById("changePasswordModal").style.display = "none";
  }

  window.onload = function() {
    var msg = document.getElementById('successMsg');
    if (msg && msg.innerText && msg.innerText.trim() !== '') {
      hideChangePasswordForm();
    }
  };


    function logout() {
      window.location.href = "/";
  }


</script>
</body>
</html>
